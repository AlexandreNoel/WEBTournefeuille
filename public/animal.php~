<?php

session_start();

include("pageAccueil.php") ;

enTete("Votre animal") ;

onglets() ;

fin_enTete() ;

animal() ;

pied() ;


function animal() {
   $tab = $_SESSION['tab'] ;
   if (($tab['pet']==NULL) && ($tab[14] < 5)) {
       echo 'Vous n avez pas d animal pour le moment, vous pourrez en choisir un Ã  partir du niveau 5' ;
   }
   else if (($tab['pet']==NULL) && ($tab[14] >= 5)) {
       echo 'Vous pouvez choisir un animal' ;
       echo '<form action="pet.php" method="post">' ;
       $tableau = liste_animaux() ;
       $i = 0 ;
       while ($i < 5) {
           $row = $tableau->fetch() ;
           animaux($row) ;
	   $i = $i+1 ;
	   echo '</br>' ;
       }
       echo '<p><button type="submit">Choisir</button></p>';
       echo '</form>' ;
   }
   else {
       $pet =$tab[9] ;
       print "<p> $pet </p>" ;
       print "<br/>" ;
       print "<img id='pet' src=\"$pet.png\" alt=\"image de $pet\"/>" ;
       print "  <ul>" ;
       print "    <li> Niveau : $tab[11] </li> " ;
       print "    <li> XP : $tab[10]</li> " ;
       print "  </ul>" ;
   }
}





function animaux($tab) {
    print "<img id='pet' src='$tab[0].jpeg' alt='image de $tab[0]'/>" ;
    print "<input type='radio' id=$tab[0] name='pet' value=$tab[0]>" ;
    print "<label for=$tab[0]> $tab[0] </label>" ;
    print "</br>" ;
}



function liste_animaux() {
    $nom_hote= "localhost" ; 
    $nom_base = getenv('DB_NAME'); 
    $nom_user = getenv('DB_USER');
    $mdp=getenv('DB_PASSWORD');
    $connection = new PDO("pgsql:host=postgres user=$nom_user dbname=$nom_base password=$mdp");
    $req = $connection->prepare("SELECT * FROM pet ;") ;
    $reponse = $req->execute([]) ;
    if ($reponse){
       return($req) ;
    }
}